<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>摩配优选 | 摩托车配件专业商城</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #e63946;
            --primary-dark: #c1121f;
            --secondary: #457b9d;
            --secondary-dark: #1d3557;
            --accent: #2a9d8f;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border-radius: 8px;
            --shadow: 0 3px 10px rgba(0, 0, 0, 0.06);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', system-ui, sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.5;
            font-size: 14px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 12px;
        }

        /* 头部样式 - 超大logo和文字 */
        .header {
            background: linear-gradient(135deg, var(--secondary-dark), var(--secondary));
            color: white;
            padding: 40px 0; /* 非常大的内边距 */
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 40px; /* 非常大的间距 */
        }

        .logo-icon {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-icon img {
            width: 240px; /* 超大尺寸 - 240px */
            height: 240px; /* 超大尺寸 - 240px */
            object-fit: contain;
            vertical-align: middle;
            filter: drop-shadow(3px 3px 5px rgba(0, 0, 0, 0.3));
        }

        .logo-text {
            font-size: 56px; /* 超大字体 - 56px */
            font-weight: 900; /* 最粗的字重 */
            color: white;
            letter-spacing: 3px; /* 更大的字母间距 */
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
        }

        .logo-subtitle {
            font-size: 36px; /* 超大副标题 - 36px */
            opacity: 0.9;
            margin-top: 15px; /* 更大的上边距 */
            color: rgba(255, 255, 255, 0.95);
            font-weight: 700;
        }

        .header-stats {
            display: flex;
            gap: 50px; /* 非常大的间距 */
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 48px; /* 超大数字 - 48px */
            font-weight: 900;
            color: var(--primary);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .stat-label {
            font-size: 24px; /* 超大标签 - 24px */
            opacity: 0.9;
            margin-top: 10px; /* 更大的上边距 */
            font-weight: 600;
        }

        /* 主内容区 */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-top: 50px; /* 更大的上边距 */
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* 商品列表区域 */
        .product-section {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .section-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--secondary-dark);
        }

        .section-subtitle {
            color: var(--gray);
            font-size: 13px;
            margin-top: 2px;
        }

        /* 筛选器样式 */
        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--secondary-dark);
        }

        .filter-select {
            padding: 6px 10px;
            border: 1px solid var(--gray-light);
            border-radius: 6px;
            background-color: white;
            color: var(--dark);
            font-size: 13px;
            cursor: pointer;
            transition: var(--transition);
            min-width: 110px;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 2px rgba(69, 123, 157, 0.1);
        }

        .filter-btn {
            padding: 6px 12px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }

        .filter-btn:hover {
            background-color: var(--secondary-dark);
        }

        .filter-btn.reset {
            background-color: var(--gray);
        }

        .filter-btn.reset:hover {
            background-color: #5a6268;
        }

        /* 商品表格 */
        .table-container {
            overflow-x: auto;
            padding: 0;
        }

        .product-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .product-table thead {
            background-color: var(--gray-light);
        }

        .product-table th {
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            color: var(--secondary-dark);
            font-size: 13px;
            white-space: nowrap;
        }

        .product-table tbody tr {
            border-bottom: 1px solid var(--gray-light);
            transition: var(--transition);
        }

        .product-table tbody tr:hover {
            background-color: #f8f9fa;
        }

        .product-table td {
            padding: 12px 10px;
            vertical-align: middle;
        }

        .product-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--secondary-dark);
            line-height: 1.4;
        }

        .category-tag {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .category-tire {
            background-color: rgba(42, 157, 143, 0.1);
            color: var(--accent);
        }

        .category-accessory {
            background-color: rgba(69, 123, 157, 0.1);
            color: var(--secondary);
        }

        .category-lighting {
            background-color: rgba(255, 183, 3, 0.1);
            color: #e9c46a;
        }

        /* 新增：价格对比样式 */
        .price-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .original-price {
            font-size: 13px;
            color: var(--gray);
            text-decoration: line-through;
            margin-bottom: 4px;
        }

        .sale-price {
            font-weight: 700;
            font-size: 15px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .sale-badge {
            background-color: var(--primary);
            color: white;
            font-size: 11px;
            padding: 1px 5px;
            border-radius: 3px;
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            gap: 6px;
        }

        .btn {
            padding: 6px 10px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
            white-space: nowrap;
        }

        .btn-add {
            background-color: var(--accent);
            color: white;
        }

        .btn-add:hover {
            background-color: #238b7d;
        }

        .btn-add:disabled {
            background-color: #b0b0b0;
            cursor: not-allowed;
        }

        .btn-detail {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-detail:hover {
            background-color: #dae0e5;
        }

        /* 购物车面板 */
        .cart-panel {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            height: fit-content;
            position: sticky;
            top: 200px; /* 调整以适应超大头部 */
        }

        .cart-header {
            padding: 18px 20px;
            background-color: var(--secondary-dark);
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .cart-title {
            font-size: 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cart-count {
            background-color: var(--primary);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
        }

        .cart-body {
            padding: 0;
            flex-grow: 1;
            max-height: 400px;
            overflow-y: auto;
        }

        .empty-cart {
            padding: 40px 20px;
            text-align: center;
            color: var(--gray);
        }

        .empty-cart-icon {
            font-size: 40px;
            margin-bottom: 12px;
            color: var(--gray-light);
        }

        .empty-cart-text {
            font-size: 14px;
            margin-bottom: 6px;
        }

        .cart-items {
            padding: 15px 0;
        }

        .cart-item {
            display: flex;
            padding: 14px 18px;
            border-bottom: 1px solid var(--gray-light);
            align-items: center;
            gap: 12px;
            transition: var(--transition);
        }

        .cart-item:hover {
            background-color: #f8f9fa;
        }

        .cart-item-info {
            flex-grow: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--secondary-dark);
            font-size: 14px;
            line-height: 1.3;
        }

        .cart-item-price {
            font-weight: 700;
            color: var(--primary);
            font-size: 14px;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .qty-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            background-color: var(--gray-light);
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-weight: 700;
            font-size: 12px;
        }

        .qty-btn:hover {
            background-color: #d0d5da;
        }

        .qty-value {
            min-width: 24px;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
        }

        .remove-btn {
            background: none;
            border: none;
            color: var(--gray);
            cursor: pointer;
            font-size: 16px;
            transition: var(--transition);
        }

        .remove-btn:hover {
            color: var(--primary);
        }

        .cart-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
        }

        .cart-summary {
            margin-bottom: 15px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .summary-row.total {
            font-size: 17px;
            font-weight: 700;
            color: var(--primary);
            margin-top: 8px;
            padding-top: 12px;
            border-top: 2px solid var(--gray-light);
        }

        .cart-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-clear {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-clear:hover {
            background-color: #dae0e5;
        }

        .btn-checkout {
            background-color: var(--primary);
            color: white;
            padding: 10px;
            font-size: 14px;
            justify-content: center;
        }

        .btn-checkout:hover {
            background-color: var(--primary-dark);
        }

        .btn-checkout:disabled {
            background-color: #b0b0b0;
            cursor: not-allowed;
        }

        /* 统计信息 */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 15px 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .stat-box {
            text-align: center;
            flex: 1;
            min-width: 130px;
        }

        .stat-box-value {
            font-size: 22px;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-bottom: 4px;
        }

        .stat-box-label {
            font-size: 13px;
            color: var(--gray);
        }

        /* 页脚 */
        .footer {
            background-color: var(--secondary-dark);
            color: white;
            margin-top: 30px;
            padding: 25px 0;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-logo {
            font-size: 24px; /* 增大页脚logo */
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--primary);
        }

        .footer-contact {
            font-size: 16px; /* 增大页脚联系方式 */
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .copyright {
            font-size: 14px; /* 增大页脚版权信息 */
            opacity: 0.7;
        }

        /* 响应式调整 - 针对移动端优化 */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr 280px;
            }
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 40px; /* 更大的间距 */
            }
            
            .logo {
                gap: 35px; /* 调整间距 */
            }
            
            .logo-icon img {
                width: 180px; /* 响应式调整 */
                height: 180px; /* 响应式调整 */
            }
            
            .logo-text {
                font-size: 42px; /* 响应式调整 */
            }
            
            .logo-subtitle {
                font-size: 28px; /* 响应式调整 */
            }
            
            .header-stats {
                width: 100%;
                justify-content: center;
                gap: 40px; /* 调整间距 */
            }
            
            .stat-value {
                font-size: 36px; /* 响应式调整 */
            }
            
            .stat-label {
                font-size: 20px; /* 响应式调整 */
            }
            
            .cart-panel {
                top: 240px; /* 响应式调整 */
            }
        }

        @media (max-width: 768px) {
            body {
                font-size: 13px;
            }
            
            .container {
                padding: 0 10px;
            }
            
            .section-header {
                padding: 12px 15px;
                flex-direction: column;
                align-items: flex-start;
            }
            
            .section-title {
                font-size: 16px;
            }
            
            .section-subtitle {
                font-size: 12px;
            }
            
            .filters {
                width: 100%;
                justify-content: flex-start;
                gap: 8px;
            }
            
            .filter-group {
                flex: 1;
                min-width: 140px;
            }
            
            .filter-label {
                font-size: 12px;
            }
            
            .filter-select {
                flex-grow: 1;
                padding: 5px 8px;
                font-size: 12px;
                min-width: 0;
            }
            
            .filter-btn {
                font-size: 12px;
                padding: 5px 10px;
            }
            
            .product-table th, 
            .product-table td {
                padding: 10px 8px;
            }
            
            .product-name {
                font-size: 13px;
            }
            
            .price-container {
                font-size: 12px;
            }
            
            .original-price {
                font-size: 12px;
            }
            
            .sale-price {
                font-size: 14px;
            }
            
            .btn {
                padding: 5px 8px;
                font-size: 11px;
            }
            
            .stat-box {
                min-width: 110px;
            }
            
            .stat-box-value {
                font-size: 18px;
            }
            
            .stat-box-label {
                font-size: 12px;
            }
            
            .cart-header {
                padding: 15px;
            }
            
            .cart-title {
                font-size: 15px;
            }
            
            .cart-item {
                padding: 12px 15px;
            }
            
            .cart-item-name {
                font-size: 13px;
            }
            
            .cart-item-price {
                font-size: 13px;
            }
            
            .cart-footer {
                padding: 15px;
            }
            
            .summary-row.total {
                font-size: 16px;
            }
            
            /* 头部响应式调整 */
            .header {
                padding: 30px 0; /* 响应式调整 */
            }
            
            .logo-icon img {
                width: 140px; /* 响应式调整 */
                height: 140px; /* 响应式调整 */
            }
            
            .logo-text {
                font-size: 36px; /* 响应式调整 */
            }
            
            .logo-subtitle {
                font-size: 24px; /* 响应式调整 */
            }
            
            .stat-value {
                font-size: 30px; /* 响应式调整 */
            }
            
            .cart-panel {
                top: 190px; /* 响应式调整 */
            }
        }

        @media (max-width: 576px) {
            .main-content {
                gap: 15px;
                margin-top: 15px;
            }
            
            .logo {
                gap: 25px;
            }
            
            .logo-icon img {
                width: 110px; /* 响应式调整 */
                height: 110px; /* 响应式调整 */
            }
            
            .logo-text {
                font-size: 30px; /* 响应式调整 */
            }
            
            .logo-subtitle {
                font-size: 20px; /* 响应式调整 */
            }
            
            .header-stats {
                gap: 30px;
            }
            
            .stat-value {
                font-size: 26px; /* 响应式调整 */
            }
            
            .stat-label {
                font-size: 18px; /* 响应式调整 */
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
                gap: 5px;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
                padding: 6px 8px;
            }
            
            .stat-box {
                min-width: calc(50% - 10px);
            }
            
            .stats-bar {
                padding: 12px 15px;
            }
            
            .cart-panel {
                position: static;
                margin-top: 15px;
            }
            
            .cart-item-controls {
                flex-wrap: wrap;
                justify-content: flex-end;
            }
            
            .cart-item {
                flex-wrap: wrap;
            }
            
            .cart-item-info {
                flex-basis: 100%;
                margin-bottom: 8px;
            }
        }

        @media (max-width: 400px) {
            .logo {
                gap: 20px;
            }
            
            .logo-icon img {
                width: 90px; /* 响应式调整 */
                height: 90px; /* 响应式调整 */
            }
            
            .logo-text {
                font-size: 26px; /* 响应式调整 */
            }
            
            .logo-subtitle {
                font-size: 18px; /* 响应式调整 */
            }
            
            .header-stats {
                gap: 25px;
            }
            
            .stat-value {
                font-size: 22px; /* 响应式调整 */
            }
            
            .stat-label {
                font-size: 16px; /* 响应式调整 */
            }
            
            .filter-group {
                min-width: 100%;
            }
            
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .product-table {
                min-width: 100%;
            }
            
            .product-table th:nth-child(1),
            .product-table td:nth-child(1) {
                width: 10%;
            }
            
            .product-table th:nth-child(2),
            .product-table td:nth-child(2) {
                width: 30%;
            }
            
            .product-table th:nth-child(3),
            .product-table td:nth-child(3) {
                width: 20%;
            }
            
            .product-table th:nth-child(4),
            .product-table td:nth-child(4) {
                width: 20%;
            }
            
            .product-table th:nth-child(5),
            .product-table td:nth-child(5) {
                width: 20%;
            }
            
            .stat-box {
                min-width: 100%;
            }
            
            /* 头部响应式调整 */
            .header {
                padding: 25px 0; /* 响应式调整 */
            }
        }

        /* 动画效果 */
        @keyframes fadeInDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeOutUp {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-20px); opacity: 0; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in-down {
            animation: fadeInDown 0.3s ease;
        }

        .fade-out-up {
            animation: fadeOutUp 0.3s ease;
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        /* 消息提示 - 重新设计 */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--accent);
            color: white;
            padding: 14px 18px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 320px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .notification.error {
            background-color: var(--primary);
        }

        .notification.warning {
            background-color: #ffa726;
            color: var(--dark);
        }

        .notification.hidden {
            opacity: 0;
            transform: translateY(-20px);
            pointer-events: none;
        }

        .notification-close {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            font-size: 16px;
            opacity: 0.8;
            transition: opacity 0.2s ease;
            margin-left: auto;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-close:hover {
            opacity: 1;
        }

        /* 新增：收款二维码弹窗样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
        }

        .payment-modal {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .payment-modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            background-color: var(--secondary-dark);
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }

        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            padding: 25px;
            text-align: center;
        }

        .order-info {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
        }

        .order-total {
            font-size: 18px;
            font-weight: 700;
            color: var(--secondary-dark);
            margin-top: 5px;
        }

        /* 新增：付款备注样式 */
        .payment-remark {
            background-color: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            margin-bottom: 25px;
            overflow: hidden;
        }
        
        .remark-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .remark-title {
            font-weight: 700;
            color: var(--secondary-dark);
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .remark-subtitle {
            font-weight: 400;
            color: var(--gray);
            font-size: 13px;
            margin-left: 5px;
        }
        
        .btn-copy {
            padding: 8px 16px;
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
        }
        
        .btn-copy:hover {
            background-color: #238b7d;
        }
        
        .btn-copy.copied {
            background-color: #2a9d8f;
        }
        
        .remark-content {
            padding: 20px;
        }
        
        #remarkText {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.5;
            resize: none;
            background-color: #f8f9fa;
            color: var(--dark);
            /* 禁止用户选择和复制 */
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            /* 禁止鼠标拖拽选择文本 */
            cursor: default;
            /* 防止文本被高亮 */
            -webkit-touch-callout: none;
        }
        
        #remarkText:focus {
            outline: none;
            border-color: var(--secondary);
        }
        
        .copy-hint {
            background-color: rgba(42, 157, 143, 0.1);
            border: 1px solid rgba(42, 157, 143, 0.3);
            color: var(--accent);
            padding: 8px 12px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: fadeIn 0.3s ease;
        }

        /* 新增：二维码保存按钮样式 */
        .qrcode-actions {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-save {
            padding: 8px 16px;
            background-color: #07c160;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
        }
        
        .btn-save.alipay {
            background-color: #1677ff;
        }
        
        .btn-save:hover {
            opacity: 0.9;
        }
        
        .btn-save:active {
            transform: translateY(1px);
        }

        .qrcode-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .qrcode-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin-top: 15px;
        }

        .qrcode-item {
            width: 100%;
            text-align: center;
        }

        .qrcode-img {
            width: 250px;
            height: 250px;
            margin: 0 auto 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .qrcode-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .qrcode-name {
            font-weight: 700;
            color: var(--secondary-dark);
            margin-top: 8px;
            font-size: 18px;
        }

        .payment-method-name {
            font-size: 16px;
            color: var(--gray);
            margin-bottom: 15px;
        }

        .payment-instructions {
            background-color: #f0f7ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 13px;
            color: var(--secondary);
            text-align: left;
        }

        .instructions-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--secondary-dark);
        }

        .instructions-list {
            padding-left: 18px;
        }

        .instructions-list li {
            margin-bottom: 5px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .modal-footer .btn {
            flex: 1;
            padding: 12px;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .btn-wechat {
            background-color: #07c160;
            color: white;
        }

        .btn-wechat:hover {
            background-color: #06ad56;
        }

        .btn-alipay {
            background-color: #1677ff;
            color: white;
        }

        .btn-alipay:hover {
            background-color: #0e6ce5;
        }

        .btn-back {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .btn-back:hover {
            background-color: #dae0e5;
        }

        @media (max-width: 768px) {
            .payment-modal {
                width: 95%;
                max-height: 85vh;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .qrcode-container {
                flex-direction: column;
                align-items: center;
            }
            
            .qrcode-img {
                width: 220px;
                height: 220px;
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            /* 付款备注响应式调整 */
            .remark-header {
                padding: 12px 15px;
            }
            
            .remark-title {
                font-size: 15px;
            }
            
            .remark-content {
                padding: 15px;
            }
            
            #remarkText {
                height: 80px;
                font-size: 12px;
            }
        }

        @media (max-width: 576px) {
            .modal-body {
                padding: 15px;
            }
            
            .modal-header {
                padding: 15px;
            }
            
            .modal-title {
                font-size: 18px;
            }
            
            .qrcode-img {
                width: 200px;
                height: 200px;
            }
            
            .order-info {
                padding: 12px;
            }
            
            .order-total {
                font-size: 16px;
            }
            
            .modal-footer {
                padding: 15px;
            }
            
            /* 付款备注响应式调整 */
            .remark-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .btn-copy {
                width: 100%;
                justify-content: center;
            }
            
            /* 二维码保存按钮响应式调整 */
            .qrcode-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .btn-save {
                width: 100%;
                max-width: 200px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- 头部 - 超大logo和文字 -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <img src="https://i.ibb.co/Kzb3GVzb/image-20251204163442-4ba79540a2ac7e635dc97cef1e82241a.png" alt="摩托车图标">
                    </div>
                    <div>
                        <div class="logo-text">摩配优选</div>
                        <div class="logo-subtitle">专业配件供应</div>
                    </div>
                </div>
                
                <div class="header-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="totalProducts">8</div>
                        <div class="stat-label">商品总数</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="cartTotal">0</div>
                        <div class="stat-label">采购商品</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">¥<span id="cartAmount">0</span></div>
                        <div class="stat-label">采购总额</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <div class="container">
        <div class="main-content">
            <!-- 商品列表 -->
            <section class="product-section">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">摩托车配件商品清单</h2>
                        <p class="section-subtitle">选择您需要的商品，加入采购单</p>
                    </div>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <label class="filter-label">分类筛选:</label>
                            <select class="filter-select" id="categoryFilter">
                                <option value="all">全部商品</option>
                                <option value="tire">轮胎</option>
                                <option value="accessory">配件</option>
                                <option value="lighting">灯光</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label">排序方式:</label>
                            <select class="filter-select" id="sortFilter">
                                <option value="default">默认排序</option>
                                <option value="price-asc">价格从低到高</option>
                                <option value="price-desc">价格从高到低</option>
                            </select>
                        </div>
                        
                        <button class="filter-btn reset" id="resetBtn">
                            <i class="fas fa-redo-alt"></i> 重置
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="product-table">
                        <thead>
                            <tr>
                                <th width="10%">序号</th>
                                <th width="30%">商品名称</th>
                                <th width="20%">分类</th>
                                <th width="20%">参考价格</th>
                                <th width="20%">操作</th>
                            </tr>
                        </thead>
                        <tbody id="productTable">
                            <!-- 商品数据将动态生成 -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- 购物车面板 -->
            <aside class="cart-panel">
                <div class="cart-header">
                    <div class="cart-title">
                        <i class="fas fa-shopping-cart"></i> 采购单
                        <div class="cart-count" id="cartCount">0</div>
                    </div>
                    <div class="cart-info" id="cartInfo">0件商品</div>
                </div>
                
                <div class="cart-body">
                    <div class="empty-cart" id="emptyCart">
                        <div class="empty-cart-icon">
                            <i class="fas fa-shopping-basket"></i>
                        </div>
                        <p class="empty-cart-text">采购单是空的</p>
                        <p>请从左侧商品列表中添加商品</p>
                    </div>
                    
                    <div class="cart-items" id="cartItems" style="display: none;">
                        <!-- 购物车商品将动态生成 -->
                    </div>
                </div>
                
                <div class="cart-footer" id="cartFooter" style="display: none;">
                    <div class="cart-summary">
                        <div class="summary-row total">
                            <span>应付总额:</span>
                            <span id="totalPrice">¥0.00</span>
                        </div>
                    </div>
                    
                    <div class="cart-actions">
                        <button class="btn btn-clear" id="clearBtn">
                            <i class="fas fa-trash-alt"></i> 清空采购单
                        </button>
                        <button class="btn btn-checkout" id="checkoutBtn" disabled>
                            <i class="fas fa-check-circle"></i> 确认采购
                        </button>
                    </div>
                </div>
            </aside>
        </div>
        
        <!-- 统计信息栏 -->
        <div class="stats-bar">
            <div class="stat-box">
                <div class="stat-box-value" id="displayCount">0</div>
                <div class="stat-box-label">当前显示商品</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value" id="totalCount">8</div>
                <div class="stat-box-label">商品总数</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value">¥<span id="priceRange">0-0</span></div>
                <div class="stat-box-label">价格范围</div>
            </div>
            <div class="stat-box">
                <div class="stat-box-value" id="cartItemsCount">0</div>
                <div class="stat-box-label">采购商品数</div>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo"></div>
                <p class="footer-contact"></p>
                <p class="copyright"></p>
            </div>
        </div>
    </footer>

    <!-- 消息提示容器 -->
    <div id="notificationContainer"></div>

    <!-- 新增：收款二维码弹窗 -->
    <div id="paymentModal" class="modal-overlay" style="display: none;">
        <div class="payment-modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">扫码支付</div>
                <button class="modal-close" id="closePaymentModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="order-info">
                    <div id="paymentMethodText">请选择支付方式</div>
                    <div class="order-total">支付金额: <span id="paymentAmount"></span></div>
                </div>
                
                <!-- 新增：商品付款备注区域 -->
                <div class="payment-remark" id="paymentRemark" style="display: none;">
                    <div class="remark-header">
                        <div class="remark-title">
                            <i class="fas fa-clipboard-list"></i> 付款备注
                            <span class="remark-subtitle">(请复制到支付平台使用)</span>
                        </div>
                        <button class="btn-copy" id="copyRemarkBtn">
                            <i class="fas fa-copy"></i> 复制
                        </button>
                    </div>
                    <div class="remark-content">
                        <textarea id="remarkText" readonly></textarea>
                        <div class="copy-hint" id="copyHint" style="display: none;">
                            <i class="fas fa-check"></i> 已复制到剪贴板
                        </div>
                    </div>
                </div>
                
                <div class="qrcode-section" id="qrcodeSection" style="display: none;">
                    <div class="payment-method-name" id="paymentMethodName"></div>
                    <div class="qrcode-container">
                        <div class="qrcode-item">
                            <div class="qrcode-img" id="singleQrcodeImg">
                                <!-- 二维码将动态设置 -->
                            </div>
                            <div class="qrcode-name" id="singleQrcodeName"></div>
                            <!-- 新增：保存图片按钮 -->
                            <div class="qrcode-actions" id="qrcodeActions">
                                <button class="btn-save" id="saveQrcodeBtn">
                                    <i class="fas fa-download"></i> 保存二维码图片
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="payment-instructions" id="paymentInstructions" style="display: none;">
                    <div class="instructions-title">支付说明:</div>
                    <ul class="instructions-list">
                        <li>请使用手机扫描上方二维码完成支付</li>
                        <li>如需保存二维码，请点击"保存二维码图片"按钮</li>
                        <li>保存后可通过相册或图库找到二维码图片</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer" id="paymentButtons">
                <button class="btn btn-wechat" id="wechatPay">
                    <i class="fab fa-weixin"></i> 微信支付
                </button>
                <button class="btn btn-alipay" id="alipayPay">
                    <i class="fab fa-alipay"></i> 支付宝支付
                </button>
            </div>
            <div class="modal-footer" id="actionButtons" style="display: none;">
                <button class="btn btn-back" id="backButton">
                    <i class="fas fa-arrow-left"></i> 返回
                </button>
            </div>
        </div>
    </div>

    <script>
        // 商品数据 - 添加原价和活动价字段
        const products = [
            { id: 1, name: "固满德山道巡礼300-10", category: "tire", originalPrice: 110, salePrice: 88 },
            { id: 2, name: "山道巡礼90-90-10", category: "tire", originalPrice: 158, salePrice: 118 },
            { id: 3, name: "山道巡礼100-90-10", category: "tire", originalPrice: 168, salePrice: 128 },
            { id: 4, name: "天选之子120-70-12", category: "tire", originalPrice: 188, salePrice: 155 },
            { id: 5, name: "天选之子130-70-12", category: "tire", originalPrice: 198, salePrice: 160 },
            { id: 6, name: "电热把", category: "accessory", originalPrice: 180, salePrice: 140 },
            { id: 7, name: "未来之眼F150PRO", category: "lighting", originalPrice: 598, salePrice: 398 },
            { id: 8, name: "螃蟹皮", category: "accessory", originalPrice: 50, salePrice: 35 }
        ];

        // 分类映射
        const categories = {
            "tire": { name: "轮胎", class: "category-tire" },
            "accessory": { name: "配件", class: "category-accessory" },
            "lighting": { name: "灯光", class: "category-lighting" }
        };

        // 购物车数据
        let cart = [];

        // 用于存储当前显示的提示消息和定时器
        let currentNotification = null;
        let notificationTimer = null;

        // 当前订单信息
        let currentOrder = {
            total: 0,
            items: [],
            paymentMethod: null,
            qrCodeUrl: null,
            qrCodeType: null
        };

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            renderProductTable(products);
            setupEventListeners();
            updateCartDisplay();
            updateStats();
            
            // 设置支付弹窗事件监听
            setupPaymentModalEvents();
        });

        // 设置支付弹窗事件监听
        function setupPaymentModalEvents() {
            // 关闭支付弹窗
            document.getElementById('closePaymentModal').addEventListener('click', hidePaymentModal);
            
            // 微信支付按钮
            document.getElementById('wechatPay').addEventListener('click', function() {
                showSingleQRCode('微信支付', 'https://i.ibb.co/GfF5yyBb/8fdff8f8908e9c30fb6e7a2af1928c88.jpg', 'wechat');
            });
            
            // 支付宝支付按钮 - 使用新的图片链接
            document.getElementById('alipayPay').addEventListener('click', function() {
                showSingleQRCode('支付宝支付', 'https://i.ibb.co/992nXZDW/bcee6db1d0859e9ac6aaf5568d953f00.jpg', 'alipay');
            });
            
            // 返回按钮
            document.getElementById('backButton').addEventListener('click', backToPaymentSelection);
            
            // 复制备注按钮事件 - 使用新的复制方法
            document.getElementById('copyRemarkBtn').addEventListener('click', copyRemarkToClipboard);
            
            // 保存二维码按钮事件
            document.getElementById('saveQrcodeBtn').addEventListener('click', saveQRCodeImage);
            
            // 点击弹窗外部关闭
            document.getElementById('paymentModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    hidePaymentModal();
                }
            });
        }

        // 显示单个二维码
        function showSingleQRCode(paymentMethod, qrCodeUrl, qrCodeType) {
            const qrcodeSection = document.getElementById('qrcodeSection');
            const paymentInstructions = document.getElementById('paymentInstructions');
            const paymentMethodText = document.getElementById('paymentMethodText');
            const paymentMethodName = document.getElementById('paymentMethodName');
            const singleQrcodeImg = document.getElementById('singleQrcodeImg');
            const singleQrcodeName = document.getElementById('singleQrcodeName');
            const paymentButtons = document.getElementById('paymentButtons');
            const actionButtons = document.getElementById('actionButtons');
            const modalTitle = document.getElementById('modalTitle');
            const paymentRemark = document.getElementById('paymentRemark');
            const saveQrcodeBtn = document.getElementById('saveQrcodeBtn');
            
            // 更新订单信息
            paymentMethodText.textContent = `已选择${paymentMethod}`;
            modalTitle.textContent = `${paymentMethod}`;
            
            // 设置二维码
            singleQrcodeImg.innerHTML = `<img src="${qrCodeUrl}" alt="${paymentMethod}二维码" id="qrcodeImage">`;
            singleQrcodeName.textContent = paymentMethod;
            paymentMethodName.textContent = `请使用${paymentMethod}扫描二维码`;
            
            // 更新保存按钮样式
            saveQrcodeBtn.innerHTML = `<i class="fas fa-download"></i> 保存${paymentMethod}二维码`;
            if (qrCodeType === 'wechat') {
                saveQrcodeBtn.className = 'btn-save';
            } else {
                saveQrcodeBtn.className = 'btn-save alipay';
            }
            
            // 显示二维码区域
            qrcodeSection.style.display = 'block';
            
            // 显示支付说明
            paymentInstructions.style.display = 'block';
            
            // 隐藏付款备注区域
            paymentRemark.style.display = 'none';
            
            // 切换按钮显示
            paymentButtons.style.display = 'none';
            actionButtons.style.display = 'flex';
            
            // 保存当前支付方式
            currentOrder.paymentMethod = paymentMethod;
            currentOrder.qrCodeUrl = qrCodeUrl;
            currentOrder.qrCodeType = qrCodeType;
            
            // 显示成功消息
            showNotification(`已选择${paymentMethod}，请扫描二维码完成支付`, 'success');
        }

        // 返回支付选择
        function backToPaymentSelection() {
            const qrcodeSection = document.getElementById('qrcodeSection');
            const paymentInstructions = document.getElementById('paymentInstructions');
            const paymentMethodText = document.getElementById('paymentMethodText');
            const paymentButtons = document.getElementById('paymentButtons');
            const actionButtons = document.getElementById('actionButtons');
            const modalTitle = document.getElementById('modalTitle');
            const paymentRemark = document.getElementById('paymentRemark');
            
            // 重置显示
            paymentMethodText.textContent = '请选择支付方式';
            modalTitle.textContent = '扫码支付';
            qrcodeSection.style.display = 'none';
            paymentInstructions.style.display = 'none';
            paymentRemark.style.display = 'block';
            
            // 切换按钮显示
            paymentButtons.style.display = 'flex';
            actionButtons.style.display = 'none';
            
            // 清除当前支付方式
            currentOrder.paymentMethod = null;
            currentOrder.qrCodeUrl = null;
            currentOrder.qrCodeType = null;
            
            showNotification('请选择支付方式', 'info');
        }

        // 渲染商品表格
        function renderProductTable(productsToShow) {
            const tableBody = document.getElementById('productTable');
            tableBody.innerHTML = '';
            
            if (productsToShow.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align:center; padding:30px;">
                            <i class="fas fa-search" style="font-size: 30px; color: #ddd; margin-bottom: 10px; display: block;"></i>
                            <p style="color: #777; font-size: 14px;">没有找到符合条件的商品</p>
                        </td>
                    </tr>`;
                updateStats(productsToShow);
                return;
            }
            
            productsToShow.forEach(product => {
                const category = categories[product.category];
                const cartItem = cart.find(item => item.id === product.id);
                const inCart = cartItem ? true : false;
                const cartQuantity = cartItem ? cartItem.quantity : 0;
                
                // 计算折扣百分比
                const discountPercent = Math.round((1 - product.salePrice / product.originalPrice) * 100);
                
                const row = document.createElement('tr');
                row.className = 'fade-in';
                row.innerHTML = `
                    <td>${product.id}</td>
                    <td>
                        <div class="product-name">${product.name}</div>
                    </td>
                    <td><span class="category-tag ${category.class}">${category.name}</span></td>
                    <td>
                        <div class="price-container">
                            <div class="original-price">原价: ¥${product.originalPrice}</div>
                            <div class="sale-price">
                                <span>活动价: ¥${product.salePrice}</span>
                                ${discountPercent > 0 ? `<span class="sale-badge">-${discountPercent}%</span>` : ''}
                            </div>
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-add" data-id="${product.id}" ${inCart ? 'disabled' : ''}>
                                <i class="fas fa-cart-plus"></i> ${inCart ? `已添加 (${cartQuantity})` : '加入采购单'}
                            </button>
                            <button class="btn btn-detail" data-id="${product.id}">
                                <i class="fas fa-info-circle"></i> 详情
                            </button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
            
            updateStats(productsToShow);
        }

        // 更新统计信息
        function updateStats(productsToShow = products) {
            document.getElementById('displayCount').textContent = productsToShow.length;
            document.getElementById('totalCount').textContent = products.length;
            
            if (productsToShow.length > 0) {
                const prices = productsToShow.map(p => p.salePrice);
                const minPrice = Math.min(...prices);
                const maxPrice = Math.max(...prices);
                document.getElementById('priceRange').textContent = `${minPrice}-${maxPrice}`;
            } else {
                document.getElementById('priceRange').textContent = "0-0";
            }
            
            // 更新头部统计
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalAmount = cart.reduce((sum, item) => sum + (item.salePrice * item.quantity), 0);
            
            document.getElementById('cartTotal').textContent = totalItems;
            document.getElementById('cartAmount').textContent = totalAmount;
            document.getElementById('cartItemsCount').textContent = totalItems;
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 分类筛选
            document.getElementById('categoryFilter').addEventListener('change', filterProducts);
            
            // 排序筛选
            document.getElementById('sortFilter').addEventListener('change', filterProducts);
            
            // 重置按钮
            document.getElementById('resetBtn').addEventListener('click', resetFilters);
            
            // 清空采购单按钮
            document.getElementById('clearBtn').addEventListener('click', clearCart);
            
            // 确认采购按钮
            document.getElementById('checkoutBtn').addEventListener('click', checkout);
            
            // 商品表格事件委托
            document.getElementById('productTable').addEventListener('click', function(e) {
                const btn = e.target.closest('button');
                if (!btn) return;
                
                const productId = parseInt(btn.getAttribute('data-id'));
                
                if (btn.classList.contains('btn-add')) {
                    addToCart(productId);
                } else if (btn.classList.contains('btn-detail')) {
                    showProductDetail(productId);
                }
            });
            
            // 购物车事件委托
            document.getElementById('cartItems').addEventListener('click', function(e) {
                const btn = e.target.closest('button');
                if (!btn) return;
                
                const cartItem = btn.closest('.cart-item');
                if (!cartItem) return;
                
                const productId = parseInt(cartItem.dataset.id);
                
                if (btn.classList.contains('qty-btn')) {
                    const change = btn.textContent === '+' ? 1 : -1;
                    updateQuantity(productId, change);
                } else if (btn.classList.contains('remove-btn')) {
                    removeFromCart(productId);
                }
            });
            
            // 购物车数量输入事件
            document.getElementById('cartItems').addEventListener('input', function(e) {
                if (e.target.classList.contains('qty-value')) {
                    const productId = parseInt(e.target.closest('.cart-item')?.dataset?.id);
                    if (productId) {
                        const newValue = parseInt(e.target.value);
                        if (!isNaN(newValue) && newValue >= 1 && newValue <= 99) {
                            updateQuantity(productId, 0, newValue);
                        }
                    }
                }
            });
        }

        // 筛选商品
        function filterProducts() {
            const category = document.getElementById('categoryFilter').value;
            const sort = document.getElementById('sortFilter').value;
            
            let filteredProducts = [...products];
            
            // 按分类筛选
            if (category !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === category);
            }
            
            // 排序
            if (sort === 'price-asc') {
                filteredProducts.sort((a, b) => a.salePrice - b.salePrice);
            } else if (sort === 'price-desc') {
                filteredProducts.sort((a, b) => b.salePrice - a.salePrice);
            }
            
            renderProductTable(filteredProducts);
        }

        // 重置筛选
        function resetFilters() {
            document.getElementById('categoryFilter').value = 'all';
            document.getElementById('sortFilter').value = 'default';
            renderProductTable(products);
            showNotification('筛选条件已重置', 'success');
        }

        // 显示商品详情
        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const category = categories[product.category];
                const discountPercent = Math.round((1 - product.salePrice / product.originalPrice) * 100);
                
                const detailInfo = {
                    1: "固满德山道巡礼300-10，高性能摩托车轮胎，适合多种路况",
                    2: "山道巡礼90-90-10，优质摩托车轮胎，提供良好的抓地力",
                    3: "山道巡礼100-90-10，宽胎设计，提升行驶稳定性",
                    4: "天选之子120-70-12，高性能运动轮胎，适合高速行驶",
                    5: "天选之子130-70-12，宽胎设计，提供更好的操控性",
                    6: "电热把手，冬季骑行保暖神器",
                    7: "未来之眼F150PRO，高性能摩托车射灯",
                    8: "螃蟹皮，优质摩托车配件"
                };
                
                let detail = detailInfo[productId] || `商品详情\n\n名称: ${product.name}\n分类: ${category.name}`;
                detail += `\n原价: ¥${product.originalPrice}`;
                detail += `\n活动价: ¥${product.salePrice}`;
                if (discountPercent > 0) {
                    detail += ` (节省¥${product.originalPrice - product.salePrice}，优惠${discountPercent}%)`;
                }
                
                alert(detail);
            }
        }

        // 添加到采购单
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            // 检查是否已在购物车中
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                // 增加数量，但不超过最大数量
                if (existingItem.quantity < 99) {
                    existingItem.quantity += 1;
                    showNotification(`"${product.name}" 数量已增加`, 'success');
                } else {
                    showNotification(`"${product.name}" 已达到最大数量 (99)`, 'warning');
                    return;
                }
            } else {
                // 添加到采购单
                cart.push({
                    id: product.id,
                    name: product.name,
                    originalPrice: product.originalPrice,
                    salePrice: product.salePrice,
                    quantity: 1
                });
                showNotification(`"${product.name}" 已添加到采购单`, 'success');
            }
            
            // 更新显示
            updateCartDisplay();
            renderProductTable(getFilteredProducts());
        }

        // 获取当前筛选后的商品列表
        function getFilteredProducts() {
            const category = document.getElementById('categoryFilter').value;
            const sort = document.getElementById('sortFilter').value;
            
            let filteredProducts = [...products];
            
            if (category !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === category);
            }
            
            if (sort === 'price-asc') {
                filteredProducts.sort((a, b) => a.salePrice - b.salePrice);
            } else if (sort === 'price-desc') {
                filteredProducts.sort((a, b) => b.salePrice - a.salePrice);
            }
            
            return filteredProducts;
        }

        // 更新购物车显示
        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            const emptyCart = document.getElementById('emptyCart');
            const cartFooter = document.getElementById('cartFooter');
            const checkoutBtn = document.getElementById('checkoutBtn');
            
            // 更新采购单信息
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
            document.getElementById('cartInfo').textContent = `${totalItems}件商品`;
            
            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartItemsContainer.style.display = 'none';
                cartFooter.style.display = 'none';
                checkoutBtn.disabled = true;
                return;
            }
            
            emptyCart.style.display = 'none';
            cartItemsContainer.style.display = 'block';
            cartFooter.style.display = 'block';
            checkoutBtn.disabled = false;
            
            // 清空现有购物车内容
            cartItemsContainer.innerHTML = '';
            
            // 计算总价
            let total = 0;
            
            // 添加每个商品到购物车显示
            cart.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item slide-in';
                itemElement.dataset.id = item.id;
                
                const itemTotal = item.salePrice * item.quantity;
                total += itemTotal;
                
                itemElement.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">¥${item.salePrice} × ${item.quantity} = ¥${itemTotal}</div>
                    </div>
                    <div class="cart-item-controls">
                        <button class="qty-btn">-</button>
                        <div class="qty-value">${item.quantity}</div>
                        <button class="qty-btn">+</button>
                        <button class="remove-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                cartItemsContainer.appendChild(itemElement);
            });
            
            // 更新总价显示
            document.getElementById('totalPrice').textContent = `¥${total.toFixed(2)}`;
            
            // 更新统计信息
            updateStats();
        }

        // 更新商品数量
        function updateQuantity(productId, change, newValue = null) {
            const item = cart.find(item => item.id === productId);
            if (!item) return;
            
            if (newValue !== null) {
                if (newValue > 99) {
                    showNotification(`"${item.name}" 已达到最大数量 (99)`, 'warning');
                    newValue = 99;
                }
                item.quantity = newValue;
            } else {
                const newQuantity = item.quantity + change;
                if (newQuantity < 1) {
                    // 如果数量为0，从采购单中移除
                    cart = cart.filter(i => i.id !== productId);
                    showNotification(`"${item.name}" 已从采购单移除`, 'success');
                } else if (newQuantity > 99) {
                    showNotification(`"${item.name}" 已达到最大数量 (99)`, 'warning');
                    item.quantity = 99;
                } else {
                    item.quantity = newQuantity;
                }
            }
            
            // 更新显示
            updateCartDisplay();
            renderProductTable(getFilteredProducts());
        }

        // 从采购单移除商品
        function removeFromCart(productId) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                showNotification(`"${item.name}" 已从采购单移除`, 'success');
            }
            
            cart = cart.filter(item => item.id !== productId);
            
            // 更新显示
            updateCartDisplay();
            renderProductTable(getFilteredProducts());
        }

        // 清空采购单
        function clearCart() {
            if (cart.length === 0) {
                showNotification('采购单已经是空的', 'warning');
                return;
            }
            
            if (confirm("确定要清空整个采购单吗？")) {
                cart = [];
                
                // 更新显示
                updateCartDisplay();
                renderProductTable(getFilteredProducts());
                
                showNotification("采购单已清空", 'success');
            }
        }

        // 确认采购 - 弹出支付二维码弹窗
        function checkout() {
            if (cart.length === 0) {
                showNotification("采购单为空，请先添加商品", 'warning');
                return;
            }
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const total = cart.reduce((sum, item) => sum + (item.salePrice * item.quantity), 0);
            
            let message = "采购单确认\n\n";
            message += "您将要采购以下商品：\n\n";
            
            cart.forEach(item => {
                message += `• ${item.name} x ${item.quantity} = ¥${(item.salePrice * item.quantity).toFixed(2)}\n`;
            });
            
            message += `\n应付总额: ¥${total.toFixed(2)}\n\n`;
            message += "确认提交采购单吗？";
            
            if (confirm(message)) {
                // 保存当前订单信息
                currentOrder = {
                    total: total,
                    items: [...cart],
                    paymentMethod: null,
                    qrCodeUrl: null,
                    qrCodeType: null
                };
                
                // 显示支付二维码弹窗
                showPaymentModal(total);
            }
        }

        // 显示支付二维码弹窗
        function showPaymentModal(total) {
            const modal = document.getElementById('paymentModal');
            const amountElement = document.getElementById('paymentAmount');
            const qrcodeSection = document.getElementById('qrcodeSection');
            const paymentInstructions = document.getElementById('paymentInstructions');
            const paymentMethodText = document.getElementById('paymentMethodText');
            const paymentButtons = document.getElementById('paymentButtons');
            const actionButtons = document.getElementById('actionButtons');
            const modalTitle = document.getElementById('modalTitle');
            const paymentRemark = document.getElementById('paymentRemark');
            
            // 更新订单信息
            amountElement.textContent = `¥${total.toFixed(2)}`;
            
            // 生成并显示付款备注
            generatePaymentRemark();
            paymentRemark.style.display = 'block';
            
            // 重置弹窗状态
            paymentMethodText.textContent = '请选择支付方式';
            modalTitle.textContent = '扫码支付';
            qrcodeSection.style.display = 'none';
            paymentInstructions.style.display = 'none';
            paymentButtons.style.display = 'flex';
            actionButtons.style.display = 'none';
            
            // 显示弹窗
            modal.style.display = 'flex';
            
            // 添加动画类
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
            
            // 禁用页面滚动
            document.body.style.overflow = 'hidden';
        }

        // 隐藏支付二维码弹窗
        function hidePaymentModal() {
            const modal = document.getElementById('paymentModal');
            
            // 移除动画类
            modal.classList.remove('active');
            
            // 等待动画完成后隐藏
            setTimeout(() => {
                modal.style.display = 'none';
                
                // 恢复页面滚动
                document.body.style.overflow = '';
            }, 300);
        }

        // 生成付款备注 - 只包含商品信息和金额
        function generatePaymentRemark() {
            if (cart.length === 0) return;
            
            let remarkText = "";
            
            // 添加商品列表，每行一个商品
            cart.forEach((item, index) => {
                const itemTotal = item.salePrice * item.quantity;
                remarkText += `${item.name} x${item.quantity} ¥${itemTotal}`;
                
                // 如果不是最后一项，添加换行
                if (index < cart.length - 1) {
                    remarkText += "\n";
                }
            });
            
            // 添加总计
            const total = cart.reduce((sum, item) => sum + (item.salePrice * item.quantity), 0);
            if (cart.length > 0) {
                remarkText += `\n总计: ¥${total.toFixed(2)}`;
            }
            
            // 设置备注文本
            document.getElementById('remarkText').value = remarkText;
        }

        // 重新设计的复制备注到剪贴板函数
        function copyRemarkToClipboard() {
            const remarkText = document.getElementById('remarkText').value;
            const copyBtn = document.getElementById('copyRemarkBtn');
            const copyHint = document.getElementById('copyHint');
            
            if (!remarkText.trim()) {
                showNotification('备注内容为空', 'warning');
                return;
            }
            
            // 方法1：使用现代Clipboard API（首选方法）
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(remarkText).then(() => {
                    showCopySuccess();
                }).catch(err => {
                    // 如果Clipboard API失败，尝试方法2
                    console.error('Clipboard API failed:', err);
                    fallbackCopyTextToClipboard(remarkText);
                });
            } else {
                // 如果浏览器不支持Clipboard API，使用备用方法
                fallbackCopyTextToClipboard(remarkText);
            }
            
            // 备用复制方法：使用document.execCommand
            function fallbackCopyTextToClipboard(text) {
                // 创建一个临时的textarea元素
                const textArea = document.createElement('textarea');
                textArea.value = text;
                
                // 设置样式使其不可见
                textArea.style.position = 'fixed';
                textArea.style.top = '0';
                textArea.style.left = '0';
                textArea.style.width = '2em';
                textArea.style.height = '2em';
                textArea.style.padding = '0';
                textArea.style.border = 'none';
                textArea.style.outline = 'none';
                textArea.style.boxShadow = 'none';
                textArea.style.background = 'transparent';
                textArea.style.color = 'transparent';
                textArea.style.zIndex = '-1';
                
                document.body.appendChild(textArea);
                
                try {
                    // 选中文本
                    textArea.select();
                    textArea.setSelectionRange(0, 99999); // 对于移动设备
                    
                    // 执行复制命令
                    const successful = document.execCommand('copy');
                    
                    if (successful) {
                        showCopySuccess();
                    } else {
                        showCopyError();
                    }
                } catch (err) {
                    console.error('Fallback copy failed:', err);
                    showCopyError();
                } finally {
                    // 无论成功与否，都移除临时元素
                    document.body.removeChild(textArea);
                }
            }
            
            // 显示复制成功
            function showCopySuccess() {
                // 显示成功提示
                copyHint.style.display = 'flex';
                
                // 更改按钮状态
                copyBtn.innerHTML = '<i class="fas fa-check"></i> 已复制';
                copyBtn.classList.add('copied');
                
                // 3秒后恢复按钮状态
                setTimeout(() => {
                    copyBtn.innerHTML = '<i class="fas fa-copy"></i> 复制';
                    copyBtn.classList.remove('copied');
                    copyHint.style.display = 'none';
                }, 3000);
                
                showNotification('付款备注已复制到剪贴板', 'success');
            }
            
            // 显示复制失败
            function showCopyError() {
                // 提供手动复制选项
                const manualCopy = confirm('复制失败，是否手动复制？\n\n点击"确定"后，备注文本将被选中，请按Ctrl+C（或Cmd+C）复制。');
                
                if (manualCopy) {
                    // 临时允许选择并选中文本
                    const textarea = document.getElementById('remarkText');
                    textarea.style.userSelect = 'auto';
                    textarea.style.webkitUserSelect = 'auto';
                    textarea.select();
                    
                    // 短暂显示后恢复不可选择
                    setTimeout(() => {
                        textarea.style.userSelect = 'none';
                        textarea.style.webkitUserSelect = 'none';
                        textarea.blur();
                    }, 2000);
                    
                    showNotification('请使用Ctrl+C（或Cmd+C）手动复制', 'info');
                } else {
                    showNotification('复制失败，请手动复制', 'warning');
                }
            }
        }

        // 保存二维码图片
        function saveQRCodeImage() {
            const qrCodeUrl = currentOrder.qrCodeUrl;
            const paymentMethod = currentOrder.paymentMethod;
            
            if (!qrCodeUrl) {
                showNotification('没有找到二维码图片', 'warning');
                return;
            }
            
            // 创建文件名
            const fileName = `摩配优选_${paymentMethod}_二维码_${new Date().getTime()}.jpg`;
            
            // 方法1：使用fetch和Blob（推荐，兼容性好）
            fetch(qrCodeUrl)
                .then(response => response.blob())
                .then(blob => {
                    // 创建下载链接
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = fileName;
                    
                    // 添加到文档并触发点击
                    document.body.appendChild(a);
                    a.click();
                    
                    // 清理
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    showNotification(`${paymentMethod}二维码已开始下载`, 'success');
                })
                .catch(error => {
                    console.error('下载二维码失败:', error);
                    
                    // 方法2：备用方法 - 直接打开图片
                    const saveConfirmed = confirm(`下载二维码失败，是否打开图片以便手动保存？\n\n点击"确定"将在新标签页打开${paymentMethod}二维码图片，然后您可以右键另存为。`);
                    
                    if (saveConfirmed) {
                        window.open(qrCodeUrl, '_blank');
                        showNotification(`已在新窗口打开${paymentMethod}二维码，请右键另存为`, 'info');
                    } else {
                        showNotification('取消保存二维码', 'info');
                    }
                });
        }

        // 显示消息提示 - 重新设计
        function showNotification(message, type = 'success') {
            const container = document.getElementById('notificationContainer');
            
            // 如果已经有消息显示，立即移除它
            if (currentNotification) {
                hideNotification(currentNotification);
                currentNotification = null;
                clearTimeout(notificationTimer);
            }
            
            // 创建新的消息提示
            const notification = document.createElement('div');
            notification.className = `notification ${type} fade-in-down`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(notification);
            currentNotification = notification;
            
            // 添加关闭按钮事件
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                hideNotification(notification);
                if (currentNotification === notification) {
                    currentNotification = null;
                }
            });
            
            // 3秒后自动移除消息
            notificationTimer = setTimeout(() => {
                if (currentNotification === notification) {
                    hideNotification(notification);
                    currentNotification = null;
                }
            }, 3000);
        }

        // 隐藏消息提示
        function hideNotification(notification) {
            if (!notification) return;
            
            notification.classList.remove('fade-in-down');
            notification.classList.add('fade-out-up');
            
            // 等待动画完成后再移除
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }
    </script>
</body>
</html>
